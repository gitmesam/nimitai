digraph G {
  rankdir="LR"
  splines=ortho;
  node [shape=box];

  json  [label="JSON" fontcolor=white color="#6666ff" fillcolor="#6666ff"
         style=filled shape=rarrow]
  ksast [label="KS AST" fontcolor=white color="#6666ff" fillcolor="#6666ff"
         style=filled shape=rarrow]
  nast  [label="Nim AST" fontcolor=white color="#6666ff" fillcolor="#6666ff"
         style=filled]
  obj   [label="User-defined\nNim Object" fontcolor=white color="#b266ff"
         fillcolor="#b266ff" style=filled]
  bin   [label="Binary" fontcolor=white color="#b266ff" fillcolor="#b266ff"
         style=filled shape=larrow]

  json  -> ksast [style=invis];
  ksast -> nast  [style=invis];
  nast  -> obj   [arrowhead=vee];
  obj   -> bin   [style=invis];
  bin   -> nast  [arrowhead=vee constraint=false];

  subgraph cluster_ct {
    json ksast nast;

    label="Spec transformation (compile-time)";
    style=filled;
    color=lightgrey;
  }

  subgraph cluster_rt {
    obj bin;

    label="Data transformation (runtime)";
    style=filled;
    color=lightgrey;
  }
}
